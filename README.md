# kpsec

특정 고객 거래내역 조회 서비스 개발

## 개발 프레임워크

 - Spring-Boot 2.4.5
 - h2 database
 - Gradle 6.8.3

## 문제해결 방법
프로젝트 구동과 동시에 JPA를 사용하여 JAVA와 DB 테이블을 맵핑하고 초기 데이터를 입력.

1.	2018년, 2019년 각 연도별 합계 금액(거래금액-수수료)이(가) 가장 많은 고객을 추출하는 API 개발.(단, 취소여부가 ‘Y’ 거래는 취소된 거래임, 합계 금액은 거래금액에서 수수료를 차감한 금액임)
 - statement 테이블과 account 테이블을 조인 후 2018년과 2019년도를 검색 조건에 넣고 연도와 계좌명, 계좌번호를 그룹화 하여 데이터를 출력.
 - 날짜를 연도로 변환하면서 문자로 취급 되기 때문에 연도를 숫자로 캐스팅.(API 기능 명세에 연도는 숫자로 출력)
 - 거래 여부도 조건문을 통해 N인 데이터 출력.

2.	2018년 또는 2019년에 거래가 없는 고객을 추출하는 API 개발.
 - statement 테이블에서 계좌번호와 연도로 그룹화 한 후 데이터를 Concatenate하여 2018년도 2019년에 중복되어 있는 값을 제거할 수 있도록 데이터를 출력.
 - Concatenate된 데이터로 2018년도와 2019년도에 동시에 거래를 한 계좌를 전부 제외 한 후 2020년도에 거래한 계좌를 제외.
 - Case 문을 통해 2018년도에만 거래가 있는 데이터는 2019년도를 출력, 2019년도에만 거래가 있는 데이터는 2018년도를 출력.
 - 해당 API 기능 명세 또한 연도가 숫자로 출력, 해당 API 기능 명세에 거래금액에서 수수료를 차감한다는 얘기가 없으니 합계금액은 거래금액의 합으로 계산.
 - 거래 여부도 조건문을 통해 N인 데이터 출력.

3.	연도별 관리점별 거래금액 합계를 구하고 합계금액이 큰 순서로 출력하는 API 개발.( 취소여부가 ‘Y’ 거래는 취소된 거래임)
 - statement 테이블을 통해 거래가 이루어진 연도를 데이터를 조회.
 - statement 테이블과 account 테이블, branch 테이블을 조인한 후 관리점명과 관리점 코드로 그룹화 하여 거래금액의 합계를 계산.
 - 거래가 이루어진 연도와 거래금액의 합계를 조합하여 데이터를 출력.
 - 해당 API 기능 명세 또한 연도가 숫자로 출력, 해당 API 기능 명세에 거래금액에서 수수료를 차감한다는 얘기가 없으니 합계금액은 거래금액의 합으로 계산.
 - 거래 여부도 조건문을 통해 N인 데이터 출력.
 
 4.	분당점과 판교점을 통폐합하여 판교점으로 관리점 이관을 하였습니다. 지점명을 입력하면 해당지점의 거래금액 합계를 출력하는 API 개발( 취소여부가 ‘Y’ 거래는 취소된 거래임,)
  - 분당점과 판교점의 데이터를 훼손 하지 않고 CASE문을 활용하여 분당점의 데이터를 판교점으로 가공.
  - 관리점명과 관리점코드로 그룹화 하여 거래금액의 합계를 계산.
  - 해당 API 기능 명세에 거래금액에서 수수료를 차감한다는 얘기가 없으니 합계금액은 거래금액의 합으로 계산.
  - 거래 여부도 조건문을 통해 N인 데이터 출력.
  - 분당점을 검색할 경우 @ControllerAdvice와 @ExceptionHandler를 사용하여 404 에러 메시지를 출력.

## 빌드 및 실행 방법
프로젝트에 포함되어 있는 gradlew를 이용하여 빌드 및 실행이 가능.
 
 Project Build
 ```bash
 gradlew build 
 ```
 
 Project Run
 ```bash
 gradlew bootRun
 ```
 
필요 시 build.gradle 파일을 수정하여 자유롭게 설정 변경 가능
